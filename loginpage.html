<html>
	<head>
		<title>LoginPage</title>
	</head>
	
	<body>
		<h1>Login</h1>
		<p id='pUserMsg'>Enter Username</p>
		
		<form>
			<input id='txtUname' type='text'>
			<p id='pPasswordMsg'>Enter Password</p>
			
			<p>
			<input id='txtPass' type='password'>
			<input id='btnShow' type='checkbox' onclick=passwordVisibility()>Show   
			</p>
			
			<p id='ptxtLoginResult' type='text'></p>

			<button type='button' id='btnSubmit' onClick=validateUser()>Submit</button>
			<button type='button' id='btnSignUp' onClick=signUp()>Sign Up</button>
			<button type='button' id='btnForgotPass' onClick=forgotPassword()>Forgot Password</button>
			
			<p id='ptxtBottom' type='text'></p>
		</form>
	</body>
</html>

<script>
    // Dictionary of usernames and passwords
    var dict = {
    	user : "password",
        u2 : "p2",
        u3 : "p3",
        u4 : "p2",
        u5 : "p3"
    };
	
    function validateUser(){
	//todo: write your code here

    	// Clean up
    	setBottomText("");

    	if(isValidUsername() == false)
    	{
		    setLoginResult("Username is not within the system...");
		    return; // Exit function
    	}
	    
	    if(isPasswordCorrect() == false)
    	{
		    setLoginResult("Password is incorrect...");
		    return; // Exit function
    	}
        else
		    setLoginResult("Access Granted...");
    }

    // Checks if username is present in dictionary
    function isValidUsername()
    {
        username = getUsername();
        if(dict[username] == undefined)
        {
            console.log("There is no such username");
            return false;
        }
        return true;
    }

    // Checks if password is correct for the given username
    function isPasswordCorrect()
    {
        var username = getUsername();
        var password = getPassword();
        // Does given password match stored password
        console.log("Actual Password: " + dict[username]);
        console.log("Given Password:  " + password);
        if(dict[username].localeCompare(password) == 0)
        {
            console.log("User \"" + username + "\" has logged in.");
            return true;
        }
        return false;
    }

    // Sets the visibility of the password field
    function passwordVisibility()
    {
        var showButton = document.getElementById("txtPass");
        if(showButton.type == "password")
            showButton.type = "text";
        else
            showButton.type = "password";
    }
    
    function signUp()
    {
        // Todo: redirect to a sign up page
        username = getUsername();
        password = getPassword();
        // Create key-value pair

        //Todo Add checking for user
        if (isValidUsername())
        {
            console.log("Account already present.");
            setBottomText("Username already in use");
            setLoginResult("");
            return;
        }

        dict[username] = password;
        if(dict[username] == undefined)
            console.log("Account not created");
        else
        {
            setBottomText("Account created");
            console.log("Account created: user=" + username + ", password=" + password);
        }
        setLoginResult("");
    }

    function forgotPassword()
    {
        // Todo: redirect to a page for answering security questions
        document.getElementById('ptxtBottom').innerHTML = "Too bad...";
        setBottomText("Too bad...");
        setLoginResult("");
    }

    // Changes the text below the password input field
    function setLoginResult(stringLoginResult)
    {
        document.getElementById('ptxtLoginResult').innerHTML = stringLoginResult;
    }

    // Changes the text below the buttons: Submit, Sign Up, and Forgot Password
    function setBottomText(stringBottomText)
    {
        document.getElementById('ptxtBottom').innerHTML = stringBottomText;
    }

    function getUsername()
    {
        return document.getElementById('txtUname').value;
    }
    function getPassword()
    {
        return document.getElementById('txtPass').value;
    }
</script>

